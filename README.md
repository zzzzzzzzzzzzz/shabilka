# shabilka
![That's life](https://img.scoop.it/QrCn3RegrkmkVO3yyLGCL4XXXL4j3HpexhjNOf_P3YmryPKwJ94QGRtDb3Sbc6KY)
## WAT
Здесь мы делаем бота для вебсима, который будет помогать нам шабить альфы. 
Всё, что раньше мы делали руками в перспективе должен будет делать этот бот. 
### Какой план?
MVP — программка, которая крутится в фоне, умеет заходить на вебсим, 
подставлять готовый список альф файлика в трафареты из другого файлика, загружать на 
вебсим, и отсылать отчёт об этом в базу данных.

При этом будет конфиг файл в котором можно указать данные для входа, 
базу данных, и, возможно, ещё какие-то поведенческие особенности по типу интервалов между сессиями на вебсиме.

Предполагается, что участники этого репозитория будут обновлять список альф, а также добавлять свои трафареты, 
будут подключены к общей базе в которую будут скидываться данные об успешных симуляциях альф. Таким образом больше не надо будет 
обмениваться альфами руками, успешно залитые можно автоматически добавлять себе (быть может с какими-то изменениями, чтобы было меньше палева).

### Структура проекта
```
-- shabilka/
    -- experiments/ # папка с разными пробными файликами и экспериментами
    -- alphas/ # папка со списками альф (можно брать их из файла, а не из базы)
    -- drivers/ # папка со всеми драйверами браузеров типа chromedriver и папка с phantomjs
    -- init/ # папка с конфигами и вспомогательными скриптами
    -- recipes/ # папка со списками шаблонов
    -- shabilka/ # исходники пакета шабилка
    -- strategies/ # папка с различными стратегиями
    -- logs/ # сюда пишутся логи (будет создана при первом пуске)
```

### Как пользоваться?
1. `git clone git@bitbucket.org:parrot1/print-service.git`
2. Сделайте virtualenv для 3-его питона: `python3 -m venv env/`
3. Установите пакет shabilka `python setup.py install`
4. Ставим браузер google-chrome и chromedriver
    * `sudo apt-get install google-chrome`
    * `wget https://chromedriver.storage.googleapis.com/2.41/chromedriver_linux64.zip`
    * `unzip chromedriver_linux64.zip`
    * Копируете драйвер в папку с проектом `mv chromedriver MyEnv/other/shabilka/`
    * Если использовали нестандартный путь, то меняете соответственно файлик src/local_config.py
5. Указываете в настройках (файл local_config.py) свои данные от вебсима (такие как EMAIL, PASSWORD), а также от базы (опции DB_*) 
6. Запуск базовой стратегии (перебор и запись в базу), указываем файл с шаблонами (рецептами) и какой шаблон использовать (по имени). Альфы берутся из базы по умолчанию пачкой по 10 штук (см. dummy.py): `python strategies/dummy.py -r recipes/example.json -rn stupid_sum --shuffle False`
7. Можно взять базовую стратегию dummy.py и доработать её под свою логику, см. подробнее сам файл
8. Добавлять что-то лучше таки в отдельных ветках, и соблюдать культуру создания pull request-ов
9. Наверняка тут ещё полно багов, баг фиксы приветствуются, конечно.
10. О структуре базы данных, и о том, что мы туда пишем думаю больше скажет сама её структура, которую можно глянуть в файле db_init.sql 
11. Стоит начать с изучения того как работает dummy.py, попутно изучая доступное апи классов Alpha, Recipe, Websim, BasicGrinder
*P.S. Думал использовать phantomJS, но по какой-то причине он не грузит формы. Может быть надо ещё что-то доставлять*
